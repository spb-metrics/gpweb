<?php





/*
RH_QUADRO.MILITAR

  'PES_IDENTIFICADOR_COD' => string '0112031745' (length=10)
  'NR_ID_PES_DGP' => string '10416' (length=5)
  'OM_CODOM' => string '010504' (length=6)
  'QQ_COD_QAS_QMS' => string '5308' (length=4)
  'POSTO_GRAD_CODIGO' => string '23' (length=2)
  'CP' => string '905117' (length=6)
  'MIL_TYPE' => string '1' (length=1)
  'NOME_GUERRA' => string 'MOTTA' (length=5)
  'NR_ORDEM_ATUAL' => string '0132' (length=4)
  'NR_ORDEM_ALMQ' => string '0000127' (length=7)
  'DT_INICIO_OM' => string '16-NOV-05' (length=9)
  'DT_INICIO_GU' => string '16-NOV-05' (length=9)
  'STATUS' => string '1' (length=1)
  'COMPORTAMENTO' => string '1' (length=1)
  'MIL_TYPE_IDT' => string 'MAPC' (length=4)
  'CATEGORIA_QAS_IDT' => string '8' (length=1)
  'MOBILIZAVEL_IND' => string 'N' (length=1)
  'POSTO_GRAD_PROVENTOS_CODIGO' => string '20' (length=2)


RH_QUADRO.PESSOA

  'IDENTIFICADOR_COD' => string '0380037820' (length=10)
  'TIP_PES_COD_TIPO_PES' => string '0' (length=1)
  'NOME' => string 'PAULO ROBERTO RODRIGUES' (length=23)
  'DT_NASCIMENTO' => string '14-OCT-59' (length=9)
  'SEXO' => string '1' (length=1)
  'ESTADO_CIVIL' => string '3' (length=1)
  'CPF' => string '29973767004' (length=11)
  'NOME_PAI' => string 'PEDRO FERREIRA RODRIGUES' (length=24)
  'NOME_MAE' => string 'HEDORITES ANNASTÁCIA RODRIGUES' (length=30)
  'PREC_CP' => string '040655472' (length=9)
  'TITULO_ELEITOR' => string '17351731813' (length=11)
  'SECAO_TE' => string '0076' (length=4)
  'ZONA_TE' => string '006' (length=3)
  'TIPO_SANGUE' => string '1' (length=1)
  'FATOR_RH' => string '1' (length=1)
  'PIS_PASEP' => string '10669246562' (length=11)
  'DT_FALECIMENTO' => string '17-OCT-06' (length=9)
  'INVALIDEZ' => string '0' (length=1)
  'CARTAO_FUSEX' => string '1' (length=1)
  'DOC_COMPROVA_TIPO_SANGUINEO' => string 'OUTROS' (length=6)
  'CERTIDAO_IDT' => string '-xxx-' (length=5)
  'CIDADE_CODIGO_NATURAL' => string '466' (length=3)
  'IDT_SIT_ESP' => string '1' (length=1)
  'NR_ID_PES_DGP' => string '15822' (length=5)
  'PESSOA_TYPE_IDT' => string 'MIL' (length=3)
  'SITUACAO_CADASTRO_IND' => string 'NP  ' (length=4)


RH_QUADRO.ORGAO

  'CODIGO' => string '15552' (length=5)
  'DISTINTIVO_COD' => string '7' (length=1)
  'ORGAO_CODIGO_POSSUI' => string '72181' (length=5)
  'AUTONOMIA_ADMINISTRATIVA' => string 'SEM' (length=3)
  'BAIRRO' => string 'SMU' (length=3)
  'DATA_CRIACAO' => string '01-MAY-98' (length=9)
  'CEP' => string '70630901' (length=8)
  'LOGRADOURO' => string 'QGEx - Bloco G - 2º Piso' (length=24)
  'NOME' => string 'Centro de Desenvolvimento de Sistemas' (length=37)
  'DATA_SUBORDINACAO' => string '01-MAY-98' (length=9)
  'SIGLA' => string 'CDS' (length=3)
  'NIVEL_SUBORDINACAO' => string 'N2' (length=2)
  'CLASS_NOME_OM' => string '451' (length=3)
  'ORGAO_CODIGO_SUBORDINADA' => string '39867' (length=5)
  'CIDADE_COD' => string '621' (length=3)
  'CMDO_MIL_AREA_COD' => string '7' (length=1)
  'RM_COD' => string '11' (length=2)
  'GP_OM_VAL_GRUPO_OM_COD' => string '5' (length=1)
  'GP_OM_VAL_VALOR_OM_COD' => string '19' (length=2)
  'NAT_OM_SUB_NAT_OM_COD' => string '4' (length=1)
  'TIPO' => string 'OM_EB' (length=5)
  'SUBTIPO' => string 'FORCA' (length=5)
  'ORIGEM' => string 'NACIONAL' (length=8)
  'REGIME' => string 'MILITAR' (length=7)
  'CODOM' => string '015552' (length=6)
  'SITUACAO' => string '1' (length=1)
  'PRIO' => string '2' (length=1)
  'CODIGO_UG' => string '160076' (length=6)
  'LATITUDE' => string '-15.77344422889' (length=15)
  'LONGITUDE' => string '-47.91668996558' (length=15)





  'CODIGO' => string '39867' (length=5)
  'DISTINTIVO_COD' => string '01' (length=2)
  'AUTONOMIA_ADMINISTRATIVA' => string 'COM' (length=3)
  'BAIRRO' => string 'Setor Militar Urbano' (length=20)
  'DATA_CRIACAO' => string '19-APR-05' (length=9)
  'CEP' => string '70630901' (length=8)
  'LOGRADOURO' => string 'QGEx - BL "G" - Térreo' (length=22)
  'NOME' => string 'Departamento de Ciência e Tecnologia' (length=36)
  'DATA_SUBORDINACAO' => string '19-APR-05' (length=9)
  'SIGLA' => string 'DCT' (length=3)
  'NIVEL_SUBORDINACAO' => string 'N1' (length=2)
  'DESCRI_PORTARIA_CRIACAO' => string 'DECRETO' (length=7)
  'DESCRI_PORTARIA_SUBORDINACAO' => string 'DECRETO' (length=7)
  'NR_PORTARIA_CRIACAO' => string '5426' (length=4)
  'NR_PORTARIA_SUBORDINACAO' => string '5426' (length=4)
  'CIDADE_COD' => string '621' (length=3)
  'CMDO_MIL_AREA_COD' => string '7' (length=1)
  'RM_COD' => string '11' (length=2)
  'GP_OM_VAL_GRUPO_OM_COD' => string '9' (length=1)
  'GP_OM_VAL_VALOR_OM_COD' => string '16' (length=2)
  'NAT_OM_SUB_NAT_OM_COD' => string '36' (length=2)
  'TIPO' => string 'OM_EB' (length=5)
  'SUBTIPO' => string 'FORCA' (length=5)
  'ORIGEM' => string 'NACIONAL' (length=8)
  'REGIME' => string 'MILITAR' (length=7)
  'CODOM' => string '039867' (length=6)
  'SITUACAO' => string '1' (length=1)
  'PRIO' => string '2' (length=1)
  'CODIGO_UG' => string '160076' (length=6)
  'LATITUDE' => string '-15.77403913141' (length=15)
  'LONGITUDE' => string '-47.91690105197' (length=15)





*/


require_once '../base.php';
require_once BASE_DIR.'/config.php';
if (!isset($GLOBALS['OS_WIN'])) $GLOBALS['OS_WIN'] = (stristr(PHP_OS, "WIN") !== false);
require_once BASE_DIR.'/incluir/funcoes_principais.php';
require_once BASE_DIR.'/incluir/db_adodb.php';
require_once BASE_DIR.'/classes/BDConsulta.class.php';
require_once BASE_DIR.'/classes/ui.class.php';
$Aplic = new CAplic();
require_once BASE_DIR.'/classes/data.class.php';
require_once BASE_DIR.'/modulos/contatos/contatos.class.php';
require BASE_DIR.'/estilo/rondon/sobrecarga.php';

echo '<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">';
echo '<head>';
echo '<meta name="Description" content="gpweb Default Style" />';
echo '<meta name="Version" content="'.$Aplic->getVersao().'" />';
echo '<meta http-equiv="Content-Type" content="text/html;charset='.(isset($localidade_tipo_caract) ? $localidade_tipo_caract : 'iso-8859-1').'" />';
echo '<title>'.(isset($config['gpweb']) ? $config['gpweb'] : 'gpweb').'</title>';
echo '<link rel="stylesheet" type="text/css" href="../estilo/rondon/estilo_'.(isset($config['estilo_css']) ? $config['estilo_css'] : 'metro').'.css" media="all" />';
echo '<style type="text/css" media="all">@import "../estilo/rondon/estilo_'.(isset($config['estilo_css']) ? $config['estilo_css'] : 'metro').'.css";</style>';
echo '<link rel="shortcut icon" href="../estilo/rondon/imagens/organizacao/10/favicon.ico" type="image/ico" />';
echo '</HEAD><body>';

echo '<table width="100%" cellspacing=0 cellpadding=0 border=0><tr><td align=center>'.dica('Site do '.$config['gpweb'], 'Clique para entrar no site oficial do '.$config['gpweb'].'.').'<a href="'.$config['endereco_site'].'" target="_blank"><img border=0 alt="gpweb" src="'.$Aplic->gpweb_logo.'"/></a>'.dicaF().'</td></tr><tr><td>&nbsp;</td></tr></table>';
echo '<br><br><br>';

$sql = new BDConsulta;
$sql->adTabela('cias');
$sql->adCampo('cia_id, cia_superior');
$cia=$sql->listaVetorChave('cia_id', 'cia_superior');
$sql->limpar();	

$string="SELECT CODIGO, ORGAO_CODIGO_SUBORDINADA, NOME FROM RH_QUADRO.ORGAO WHERE TIPO!='ORGAO_EXT' AND SITUACAO ='1'";


$string="SELECT RH_QUADRO.ORGAO.* FROM RH_QUADRO.ORGAO WHERE TIPO!='ORGAO_EXT' AND SITUACAO ='1'";

$conn=OCILogon('CDS_REINERT', 'reinert', 'EBCORP_DES', 'WE8ISO8859P15') or die(var_dump(ocierror())); 
$resp = OCIParse($conn, $string);
OCIExecute($resp);

$aditancias=array(74021=>74021, 74153=>74153, 74062=>74062, 74229=>74229, 74187=>74187, 74195=>74195, 74120=>74120, 74161=>74161, 74260=>74260, 74203=>74203, 74286=>74286, 74245=>74245, 74088=>74088, 74278=>74278, 74179=>74179, 74294=>74294, 74070=>74070, 74237=>74237, 74013=>74013, 74096=>74096, 74104=>74104, 74252=>74252, 74039=>74039, 74047=>74047, 74054=>74054, 74112=>74112, 74211=>74211, 74146=>74146, 74138=>74138);

while (($linha = oci_fetch_array($resp, OCI_ASSOC))){
	if (!isset($cia[$linha['CODIGO']])){
		$sql->adTabela('cias');
		$sql->adInserir('cia_id', $linha['CODIGO']);
		if (isset($linha['LOGRADOURO'])) $sql->adInserir('cia_endereco1', $linha['LOGRADOURO']);
		if (isset($linha['BAIRRO'])) $sql->adInserir('cia_endereco2', $linha['BAIRRO']);
		if (isset($linha['CEP'])) $sql->adInserir('cia_cep', $linha['CEP']);
		if (isset($linha['CODOM'])) $sql->adInserir('cia_codigo', $linha['CODOM']);
		if (isset($linha['SIGLA'])) $sql->adInserir('cia_nome', $linha['SIGLA']);
		if (isset($linha['NOME'])) $sql->adInserir('cia_nome_completo', $linha['NOME']);
		if (isset($linha['CODIGO_UG'])) $sql->adInserir('cia_ug', $linha['CODIGO_UG']);
		if (isset($linha['ORGAO_CODIGO_SUBORDINADA'])) $sql->adInserir('cia_superior', $linha['ORGAO_CODIGO_SUBORDINADA']);
		elseif (in_array($linha['CODIGO'], $aditancias)) $sql->adInserir('cia_superior', 15412);
		elseif ($linha['CODIGO']=='7179') $sql->adInserir('cia_superior', 25262);  //Batalhão de Infantaria de Força de Paz => coter
		elseif ($linha['CODIGO']=='63222') $sql->adInserir('cia_superior', 63016);  //Comando de Defesa Aeroespacial Brasileiro => Ministério da Defesa
		elseif ($linha['CODIGO']=='55293') $sql->adInserir('cia_superior', 1);  //Gabinete da Vice Presidência da República
		elseif ($linha['CODIGO']=='54866') $sql->adInserir('cia_superior', 1);  //Gabinete de Segurança Institucional da Presidência da República
		elseif ($linha['CODIGO']=='61960') $sql->adInserir('cia_superior', 39867);  //IMBEL => DCT
		elseif ($linha['CODIGO']=='63016') $sql->adInserir('cia_superior', 1);  //Ministério da Defesa
		elseif ($linha['CODIGO']=='72603') $sql->adInserir('cia_superior', 1);  //Superior Tribunal Militar
		elseif ($linha['CODIGO']=='54890') $sql->adInserir('cia_superior', 63016);  //Gabinete do Comandante do Exército
		elseif ($linha['CODIGO']=='84368') $sql->adInserir('cia_superior', 18606);  //10ª Delegacia do Serviço Militar da 15ª C S M => 15ª C S M
		elseif ($linha['CODIGO']=='84392') $sql->adInserir('cia_superior', 18903);  //7ª Delegacia do Serviço Militar da 18ª C S M => 18ª C S M
		else $sql->adInserir('cia_superior', 54890);
		$sql->sem_chave_estrangeira();
		$sql->exec();
		$sql->limpar();
		}
	elseif (isset($linha['ORGAO_CODIGO_SUBORDINADA']) && $linha['ORGAO_CODIGO_SUBORDINADA'] && $cia[$linha['CODIGO']]!=$linha['ORGAO_CODIGO_SUBORDINADA'])	{
		$sql->adTabela('cias');
		$sql->adAtualizar('cia_superior', $linha['ORGAO_CODIGO_SUBORDINADA']);
		$sql->adOnde('cia_id = '.(int)$linha['CODIGO']);
		$sql->sem_chave_estrangeira();
		$sql->exec();
		$sql->limpar();
		}
	}





ver2('Feito'); 


echo '</body></html>';

?>